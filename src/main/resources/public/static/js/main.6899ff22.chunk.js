(this.webpackJsonpnew_frontend=this.webpackJsonpnew_frontend||[]).push([[0],{32:function(e,t,n){},33:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),c=n(18),o=n.n(c),s=n(3),i=n(6),l=n(2),d=n(4);var u=function(){return Object(r.jsx)("nav",{children:Object(r.jsxs)("ul",{className:"nav",children:[Object(r.jsx)("li",{className:"nav-link",children:Object(r.jsx)(s.b,{to:"/start",children:Object(r.jsx)("button",{className:"nav-button",children:"Start"})})}),Object(r.jsx)("li",{className:"nav-link",children:Object(r.jsx)(s.b,{to:"/board",children:Object(r.jsx)("button",{className:"nav-button",children:"Boards"})})}),Object(r.jsx)("li",{className:"nav-link",children:Object(r.jsx)(s.b,{to:"/account",children:Object(r.jsx)("button",{className:"nav-button",children:"Account"})})})]})})};var j=function(e){var t=e.user,n=Object(a.useState)([]),c=Object(l.a)(n,2),o=c[0],i=c[1],d=Object(a.useState)([]),u=Object(l.a)(d,2),j=u[0],h=u[1];return Object(a.useEffect)((function(){fetch("/api/users/".concat(t.username),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.token)}}).then((function(e){return e.json()})).then((function(e){i(e.payload.boardsOwned),h(e.payload.boardsWhereIsMember)}))}),[t]),Object(r.jsxs)("section",{children:[Object(r.jsx)("h4",{children:"Boards"}),Object(r.jsx)("div",{children:Object(r.jsx)(s.b,{to:"/boardcreator",children:Object(r.jsx)("button",{className:"button-primary",children:"Create new board"})})}),Object(r.jsx)("h6",{children:"My boards"}),Object(r.jsx)("ul",{className:"board-preview-list",children:o.map((function(e){return Object(r.jsx)("li",{children:Object(r.jsx)(s.b,{to:"/board/".concat(e.name),children:e.name})},e.name)}))}),Object(r.jsx)("h6",{children:"My board memberships"}),Object(r.jsx)("ul",{className:"board-preview-list",children:j.map((function(e){return Object(r.jsx)("li",{children:Object(r.jsx)(s.b,{to:"/board/".concat(e.name),children:e.name})},e.name)}))})]})};var h=function(e){var t=e.user;return Object(r.jsxs)("section",{children:[Object(r.jsx)("h4",{children:"Start"}),Object(r.jsxs)("h6",{children:["Welcome ",t.username]})]})};var b=function(e){var t=e.user,n=Object(d.h)().board,c=Object(a.useState)(""),o=Object(l.a)(c,2),s=o[0],i=o[1],u=Object(a.useState)(""),j=Object(l.a)(u,2),h=j[0],b=j[1],p=Object(d.g)();return Object(r.jsxs)("section",{children:[Object(r.jsx)("h4",{children:"Placard Creator"}),Object(r.jsxs)("h6",{children:[s.length>0?s:"Placard title"," at the board"," ",n]}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/api/placards/placardboard/".concat(n),{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(t.token)},body:JSON.stringify({header:s,text:h})}).then((function(e){if(201!==e.status)throw new Error("Failed to set title");return e.json()})).then((function(e){p.push("/board/".concat(n))})).catch((function(e){return console.log(e)}))},children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{htmlFor:"placard-header-field",children:"Placard title"}),Object(r.jsx)("input",{value:s,onChange:function(e){i(e.target.value)},className:"placard-input-title",type:"text",id:"placard-header-field",name:"placard-header-field",placeholder:"Title of placard..."}),Object(r.jsx)("label",{htmlFor:"placard-text-field",children:"Text"}),Object(r.jsx)("textarea",{value:h,onChange:function(e){b(e.target.value)},className:"placard-input-text",id:"placard-text-field",name:"placard-text-field",placeholder:"Text on the placard..."})]}),Object(r.jsx)("button",{type:"submit",className:"button-primary",children:"Submit"})]})]})};var p=function(e){var t=e.user,n=Object(a.useState)(""),c=Object(l.a)(n,2),o=c[0],s=c[1],i=(Object(d.h)().name,Object(d.g)());return Object(r.jsxs)("section",{children:[Object(r.jsx)("h4",{children:"Board creator"}),Object(r.jsx)("h6",{children:o.length>0?o:"Title of the board"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/api/placardboards/",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(t.token)},body:JSON.stringify({name:o,isPublic:!0})}).then((function(e){if(201===e.status)return e.json();if(409===e.status)throw new Error("A board with that name already exists (board names must be unique)");if(400===e.status)throw new Error("The server interpreted the request as not valid");throw Error("Could not create board: unexpected behaviour from the server")})).then((function(e){i.push("/boardeditor/".concat(o))})).catch((function(e){return console.log(e)}))},children:[Object(r.jsx)("label",{htmlFor:"board-title-field",children:"Board title"}),Object(r.jsx)("input",{value:o,onChange:function(e){s(e.target.value)},className:"board-input-title",type:"text",id:"board-title-field",name:"board-title-field",placeholder:"Title of board..."}),Object(r.jsx)("button",{type:"submit",className:"button-primary",children:"Create"})]})]})};var O=function(e){var t=e.member,n=e.onRemove;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("span",{children:t}),Object(r.jsx)("button",{onClick:function(){return n(t)},children:"Remove"})]})};var m=function(e){var t=e.user,n=Object(a.useState)(""),c=Object(l.a)(n,2),o=c[0],s=c[1],i=Object(a.useState)([]),u=Object(l.a)(i,2),j=u[0],h=u[1],b=Object(a.useState)(""),p=Object(l.a)(b,2),m=p[0],f=p[1],x=Object(a.useState)(0),v=Object(l.a)(x,2),w=v[0],g=v[1],y=Object(d.h)().name,E=Object(d.g)(),S=1;function T(e){(function(e){return fetch("/api/placardboards/".concat(o,"/members/").concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.token)}}).then((function(e){if(200===e.status)return e.json();if(404===e.status)throw new Error("404");if(403===e.status)throw new Error("403");throw new Error("Unexpected behaviour from the server. The member may or may not be deleted.")}))})(e).then((function(e){g(w+1)})).catch(console.log)}return Object(a.useEffect)((function(){fetch("/api/placardboards/".concat(y),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.token)}}).then((function(e){if(200===e.status)return e.json();if(404===e.status)throw new Error("The requested board does not exist");if(403===e.status)throw new Error("The signed in user is not allowed to see this board");throw new Error("Could not load placard board: unexpected behaviour from the server.")})).then((function(e){s(e.payload.name)})).catch(console.log),fetch("/api/placardboards/".concat(y,"/members"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.token)}}).then((function(e){if(200===e.status)return e.json();if(404===e.status)throw new Error("The requested board does not exist");throw new Error("Could not load placard board: unexpected behaviour from the server.")})).then((function(e){h(e.payload)})).catch(console.log)}),[w]),Object(r.jsxs)("section",{children:[Object(r.jsxs)("h4",{children:["Board editor for ",o]}),Object(r.jsx)("h5",{children:"Settings"}),Object(r.jsx)("button",{onClick:function(e){e.preventDefault(),fetch("/api/placardboards/".concat(o),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.token)}}).then((function(e){if(200===e.status)return e.json();if(404===e.status)throw new Error("The requested board could not be found");if(403===e.status)throw new Error("The signed in user is not allowed to see or modify this board");throw new Error("Unexpected behaviour from the server. The board may or may not be deleted.")})).then((function(e){E.push("/board")})).catch(console.log)},children:"Delete this board"}),Object(r.jsx)("h5",{children:"Members"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/api/placardboards/".concat(o,"/members"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.token)},body:JSON.stringify({username:m})}).then((function(e){if(200===e.status)return e.json();if(404===e.status)throw new Error("The board to which to add the user could not be found.");throw new Error("Unexpected behaviour from the server. The user may or may not have been added as a member.")})).then((function(e){f(""),g(w+1)})).catch(console.log)},children:[Object(r.jsx)("label",{htmlFor:"board-member-field",children:"Member to add"}),Object(r.jsx)("input",{value:m,onChange:function(e){f(e.target.value)},className:"board-input-member",type:"text",id:"board-member-field",name:"board-member-field",placeholder:"Member name..."}),Object(r.jsx)("button",{type:"submit",children:"Add member"})]}),Object(r.jsx)("h6",{children:"Current members"}),Object(r.jsx)("ul",{className:"members-list",children:j.map((function(e){return Object(r.jsx)("li",{children:Object(r.jsx)(O,{member:e,onRemove:T})},"".concat(e).concat(S++))}))})]})},f=n(11),x=n(20);var v=function(e){var t=e.onSignIn,n=Object(a.useState)({username:"",password:""}),c=Object(l.a)(n,2),o=c[0],d=c[1];function u(e){d(Object(i.a)(Object(i.a)({},o),{},Object(f.a)({},e.target.name,e.target.value)))}return Object(r.jsxs)("section",{children:[Object(r.jsx)("h5",{children:"Sign in"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/api/authenticate",{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json"},body:JSON.stringify(o)}).then((function(e){if(200!==e.status)throw new Error("Failed to login");return e.json()})).then((function(e){var n=e.jwtToken;t({username:Object(x.a)(n).sub,token:n})})).catch(console.log)},children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{htmlFor:"login-username-field",children:"Username"}),Object(r.jsx)("input",{value:o.username,onChange:u,className:"access-input",type:"text",id:"login-username-field",name:"username",placeholder:"Enter username..."})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{htmlFor:"login-password-field",children:"Password"}),Object(r.jsx)("input",{value:o.password,onChange:u,className:"access-input",type:"password",id:"login-password-field",name:"password",placeholder:"Enter password..."})]}),Object(r.jsx)("button",{type:"submit",className:"button-primary",children:"Sign in"})]}),Object(r.jsxs)("p",{children:["Don't have an account yet?"," ",Object(r.jsx)(s.b,{to:"/register",children:"Register here"}),"."]})]})},w=n(21);var g=function(e){var t=e.onRegistration,n=Object(a.useState)({username:"",password:""}),c=Object(l.a)(n,2),o=c[0],d=c[1];function u(e){d(Object(i.a)(Object(i.a)({},o),{},Object(f.a)({},e.target.name,e.target.value)))}return Object(r.jsxs)("section",{children:[Object(r.jsx)("h5",{children:"Register"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/api/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:o.username,password:o.password})}).then((function(e){if(201===e.status)return e.json();if(200===e.status)throw new Error("Username is not available");if(400===e.status)throw new Error("Password or username not between 5-20 characters");throw new Error("Unexpected response from server")})).then((function(e){var n=e.token;Object(w.a)(e,["token"]);t(Object(i.a)(Object(i.a)({},o),{},{token:n}))})).catch((function(e){console.log(e)}))},children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{htmlFor:"register-username-field",children:"Username"}),Object(r.jsx)("input",{value:o.username,onChange:u,className:"access-input",type:"text",id:"register-username-field",name:"username",placeholder:"Enter username..."})]}),Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{htmlFor:"register-password-field",children:"Password"}),Object(r.jsx)("input",{value:o.password,onChange:u,className:"access-input",type:"password",id:"register-password-field",name:"password",placeholder:"Enter password..."})]}),Object(r.jsx)("button",{type:"submit",className:"button-primary",children:"Register account"})]}),Object(r.jsxs)("p",{children:["Already have an account? ",Object(r.jsx)(s.b,{to:"/login",children:"Sign in here"}),"."]})]})};var y=function(e){var t=e.onDelete,n=e.onSignOut,a=e.user;return Object(r.jsxs)("section",{children:[Object(r.jsx)("h4",{children:"My account"}),Object(r.jsxs)("p",{children:["Signed in as ",a.username]}),Object(r.jsx)("button",{onClick:n,className:"button-primary",children:"Sign out"}),Object(r.jsx)("h6",{children:"Delete account"}),Object(r.jsx)("button",{onClick:t,children:"Delete my account"})]})};var E=function(e){var t=e.placard,n=e.user,a=e.boardowner,c=e.onDelete;return Object(r.jsxs)("article",{className:"placard",children:[Object(r.jsx)("h5",{className:"placard-header",children:t.header}),Object(r.jsxs)("span",{className:"placard-author",children:[Object(r.jsx)("strong",{children:"Author:"})," ",Object(r.jsx)("span",{className:"italics",children:t.user})]}),Object(r.jsx)("p",{children:t.text}),Object(r.jsx)("ul",{className:"placard-actions-list",children:(t.user===n.username||a===n.username)&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("li",{className:"placard-action-list-item",children:Object(r.jsx)("button",{onClick:function(){return c(t.id)},children:"Delete"})}),Object(r.jsx)("li",{className:"placard-action-list-item",children:Object(r.jsx)(s.b,{to:"/placardeditor/".concat(t.id),children:Object(r.jsx)("button",{className:"button-primary",children:"Edit"})})})]})})]})};var S=function(e){var t=e.user,n=Object(d.h)().name,c=Object(a.useState)(""),o=Object(l.a)(c,2),i=o[0],u=o[1],j=Object(a.useState)(1),h=Object(l.a)(j,2),b=h[0],p=h[1],O=Object(a.useState)([]),m=Object(l.a)(O,2),f=m[0],x=m[1];function v(e){(function(e){return fetch("/api/placards/".concat(e),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.token)}}).then((function(e){if(200===e.status)return e.json();throw new Error("Could not perform request")}))})(e).then((function(){return p(b+1)})).catch(console.log)}return Object(a.useEffect)((function(){fetch("/api/placardboards/".concat(n),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t.token)}}).then((function(e){if(200===e.status)return e.json();if(404===e.status)throw new Error("The requested board does not exist");if(403===e.status)throw new Error("The signed in user is not allowed to see this board");throw new Error("Could not load placard board: unexpected behaviour from the server.")})).then((function(e){x(e.payload.placards),u(e.payload.owner)})).catch(console.log)}),[t,n,b]),Object(r.jsxs)("section",{children:[Object(r.jsx)("h4",{children:n}),Object(r.jsxs)("div",{className:"button-row",children:[t.username===i&&Object(r.jsx)(s.b,{to:"/boardeditor/".concat(n),children:Object(r.jsx)("button",{children:"Edit board"})}),Object(r.jsx)(s.b,{to:"/placardcreator/".concat(n),children:Object(r.jsx)("button",{className:"button-primary",children:"Make new post"})})]}),Object(r.jsx)("ul",{className:"board-preview-list",children:f.map((function(e){return Object(r.jsx)("li",{children:Object(r.jsx)(E,{placard:e,user:t,boardowner:i,onDelete:v})},e.id)}))})]})};var T=function(e){var t=e.user,n=Object(d.h)().name,c=Object(a.useState)(""),o=Object(l.a)(c,2),s=o[0],i=o[1],u=Object(a.useState)(""),j=Object(l.a)(u,2),h=j[0],b=j[1],p=Object(d.g)();return Object(a.useEffect)((function(){fetch("/api/placards/".concat(n),{method:"GET",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(t.token)}}).then((function(e){if(200!==e.status)throw new Error("Failed to fetch resource");return e.json()})).then((function(e){i(e.payload.header),b(e.payload.text)})).catch(console.log)}),[]),Object(r.jsxs)("section",{children:[Object(r.jsxs)("h4",{children:["Placard Editor for ",s]}),Object(r.jsx)("h6",{children:s.length>0?s:"Placard title"}),Object(r.jsxs)("form",{onSubmit:function(e){e.preventDefault(),fetch("/api/placards/".concat(n),{method:"PUT",headers:{"Content-Type":"application/json",Accept:"application/json",Authorization:"Bearer ".concat(t.token)},body:JSON.stringify({header:s,text:h})}).then((function(e){if(200!==e.status)throw new Error("Failed to update placard");return e.json()})).then((function(e){p.push("/board")})).catch((function(e){return console.log(e)}))},children:[Object(r.jsxs)("div",{children:[Object(r.jsx)("label",{htmlFor:"placard-header-field",children:"Placard title"}),Object(r.jsx)("input",{value:s,onChange:function(e){i(e.target.value)},className:"placard-input-title",type:"text",id:"placard-header-field",name:"placard-header-field",placeholder:"Title of placard..."}),Object(r.jsx)("label",{htmlFor:"placard-text-field",children:"Text"}),Object(r.jsx)("textarea",{value:h,onChange:function(e){b(e.target.value)},className:"placard-input-text",id:"placard-text-field",name:"placard-text-field",placeholder:"Text on the placard..."})]}),Object(r.jsx)("button",{type:"submit",className:"button-primary",children:"Submit"})]})]})};n(32);var N=function(){var e=Object(a.useState)({user:{username:"",token:""},userIsSignedIn:!1}),t=Object(l.a)(e,2),n=t[0],c=t[1],o=Object(d.g)();function s(e){c(Object(i.a)(Object(i.a)({},n),{},{user:e,userIsSignedIn:!0}))}function O(){c(Object(i.a)(Object(i.a)({},n),{},{user:{username:"",token:""},userIsSignedIn:!1}))}return Object(a.useEffect)((function(){n.userIsSignedIn&&o.push("/start")})),Object(r.jsxs)("div",{className:"App container",children:[!1,Object(r.jsxs)("header",{className:"header-main",children:[Object(r.jsx)("h4",{children:"Placard Board"}),Object(r.jsx)(u,{})]}),Object(r.jsx)("main",{children:Object(r.jsxs)(d.d,{children:[Object(r.jsx)(d.b,{exact:!0,path:"/",children:n.userIsSignedIn?Object(r.jsx)(h,{user:n.user}):Object(r.jsx)(d.a,{to:"/login"})}),Object(r.jsx)(d.b,{path:"/login",children:Object(r.jsx)(v,{onSignIn:s})}),Object(r.jsx)(d.b,{path:"/register",children:Object(r.jsx)(g,{onRegistration:s})}),n.userIsSignedIn&&Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(d.b,{path:"/start",children:Object(r.jsx)(h,{user:n.user})}),Object(r.jsx)(d.b,{path:"/board/:name",children:Object(r.jsx)(S,{user:n.user})}),Object(r.jsx)(d.b,{exact:!0,path:"/board",children:Object(r.jsx)(j,{user:n.user})}),Object(r.jsx)(d.b,{path:"/placardcreator/:board",children:Object(r.jsx)(b,{user:n.user})}),Object(r.jsx)(d.b,{path:"/boardeditor/:name",children:Object(r.jsx)(m,{user:n.user})}),Object(r.jsx)(d.b,{exact:!0,path:"/boardcreator",children:Object(r.jsx)(p,{user:n.user})}),Object(r.jsx)(d.b,{path:"/placardeditor/:name",children:Object(r.jsx)(T,{user:n.user})}),Object(r.jsx)(d.b,{path:"/account",children:Object(r.jsx)(y,{onDelete:function(){fetch("/api/users/".concat(n.user.username),{method:"DELETE",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n.user.token)}}).then((function(e){if(200!==e.status)throw new Error("Could not delete the signed in account");return e.json()})).then((function(){return O()})).catch(console.log)},onSignOut:O,user:n.user})})]}),Object(r.jsx)(d.b,{path:"/*",children:Object(r.jsx)(d.a,{to:"/login"})})]})})]})};o.a.render(Object(r.jsx)(s.a,{children:Object(r.jsx)(N,{})}),document.getElementById("root"))}},[[33,1,2]]]);
//# sourceMappingURL=main.6899ff22.chunk.js.map